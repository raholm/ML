---
title: "Introduction to Machine Learning"
subtitle: "Lab 2 Block 2"
author: "Rasmus Holm"
date: "`r Sys.Date()`"
fontsize: 10pt
geometry: margin=1in
output:
    pdf_document:
        toc: true
        number_sections: false
        fig_caption: yes
        keep_tex: yes
        includes:
            in_header: styles.sty
---

```{r global-options, echo = FALSE, eval=TRUE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
knitr::opts_chunk$set(fig.pos='H', fig.align='center')

knitr::read_chunk("../assignment2a/solution.R")
knitr::read_chunk("../assignment3a/solution.R")
knitr::read_chunk("../assignment4a/solution.R")

knitr::read_chunk("../assignment1b/solution.R")
```

\newpage

# Assignment 1a
Assumptions:

\begin{gather*}
\mathrm{E} \left[ \epsilon^{b}(x) \right] = 0, \\
\forall_{i,j}, i \neq j: \mathrm{E} \left[ \epsilon^{i}(x) \epsilon^{j}(x) \right] = 0
\end{gather*}

Prove:

\begin{gather*}
\mathrm{E}_{X} \left[ (f_{\textit{bag}}(x) - h(x))^{2} \right] =
\frac{1}{B} \left[ \frac{1}{B} \mathrm{E}_{X} \left[ (f^{b}(x) - h(x))^{2} \right] \right]
\end{gather*}

We know:

\begin{gather*}
f^{b}(x) = h(x) + \epsilon^{b}(x)
\end{gather*}

Proof:

\begin{gather*}
\mathrm{E}_{X} \left[ (f_{\textit{bag}}(x) - h(x))^{2} \right] = \\
\mathrm{E}_{X} \left[ (\frac{1}{B} \sum_{b} f^{b}(x) - h(x))^{2} \right] = \\
\mathrm{E}_{X} \left[ (\frac{1}{B} \sum_{b} \epsilon^{b}(x))^{2} \right] = \\
\frac{1}{B^{2}}
\mathrm{E}_{X} \left[ (\epsilon^{1}(x))^{2} +
2 \epsilon^{1}(x) \epsilon^{2}(x) +
\dotsb +
2 \epsilon^{b-1}(x) \epsilon^{b}(x) +
(\epsilon^{b}(x))^{2} \right] = \\
\frac{1}{B^{2}}
\left(
\mathrm{E}_{X} \left[ (\epsilon^{1}(x))^{2} \right] +
2 \mathrm{E}_{X} \left[ \epsilon^{1}(x) \epsilon^{2}(x) \right]
+ \dotsb +
2 \mathrm{E}_{X} \left[ \epsilon^{b-1}(x) \epsilon^{b}(x) \right] +
\mathrm{E}_{X} \left[ (\epsilon^{b}(x))^{2} \right]
\right) = \\
\frac{1}{B^{2}} \sum_{b} \mathrm{E}_{X} \left[ (\epsilon^{b}(x))^{2} \right] = \\
\frac{1}{B^{2}} \sum_{b} \mathrm{E}_{X} \left[ (f^{b}(x) - h(x))^{2} \right] = \\
\frac{1}{B} \left[ \frac{1}{B} \mathrm{E}_{X} \left[ (f^{b}(x) - h(x))^{2} \right] \right]
\end{gather*}

\newpage

# Assignment 1b

\newpage

# Assignment 2a
```{r, echo=FALSE, eval=TRUE}
<<assign2a-init>>
```

## 1
```{r, echo=FALSE, eval=TRUE}
<<assign2a-1-upperbound>>
```

## 2
```{r, echo=FALSE, eval=TRUE}
<<assign2a-2-upperbound>>
```

## 3
```{r, echo=FALSE, eval=TRUE}
<<assign2a-3-bag>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign2a-3-bagcv>>
```

\newpage

# Assignment 2b
```{r, echo=FALSE, eval=TRUE}
<<assign1b-init>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The true probabilities of the multinomal distributions."}
<<assign1b-plot-truemu>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign1b-EM-K2>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The estimated probabilities of the multinomal distributions."}
<<assign1b-plot-estimatemu2>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The log-likelihood versus the number of iterations."}
<<assign1b-plot-llik2>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign1b-EM-K3>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The estimated probabilities of the multinomal distributions."}
<<assign1b-plot-estimatemu3>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The log-likelihood versus the number of iterations."}
<<assign1b-plot-llik3>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign1b-EM-K4>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The estimated probabilities of the multinomal distributions."}
<<assign1b-plot-estimatemu4>>
```

```{r, echo=FALSE, eval=TRUE, fig.cap="The log-likelihood versus the number of iterations."}
<<assign1b-plot-llik4>>
```

\newpage

# Assignment 3a
```{r, echo=FALSE, eval=TRUE}
<<assign3a-init>>
```

## 1
```{r, echo=FALSE, eval=TRUE}
<<assign3a-plot>>
```

## 2
```{r, echo=FALSE, eval=TRUE}
<<assign3a-2>>
```

\newpage

# Assignment 4a
```{r, echo=FALSE, eval=TRUE}
<<assign4a-init>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign4a-tree>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign4a-tree-plot>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign4a-forest>>
```

```{r, echo=FALSE, eval=TRUE}
<<assign4a-forest-plot>>
```

\newpage

# Appendix

## Code for Assignment 1b
```{r, echo=TRUE, eval=FALSE, tidy=FALSE, highlight=TRUE}
<<assign1b-init>>
<<assign1b-plot-truemu>>
<<assign1b-EM>>
<<assign1b-plot-estimatemu>>
<<assign1b-plot-llik>>
```

## Code for Assignment 2a
```{r, echo=TRUE, eval=FALSE, tidy=FALSE, highlight=TRUE}
<<assign2a-init>>
<<assign2a-1-upperbound>>
<<assign2a-2-upperbound>>
<<assign2a-3-bag>>
<<assign2a-3-bagcv>>
```

## Code for Assignment 2b
```{r, echo=TRUE, eval=FALSE, tidy=FALSE, highlight=TRUE}
<<assign1b-init>>
<<assign1b-plot-truemu>>
<<assign1b-EM-K2>>
<<assign1b-plot-estimatemu2>>
<<assign1b-plot-llik2>>
<<assign1b-EM-K3>>
<<assign1b-plot-estimatemu3>>
<<assign1b-plot-llik3>>
<<assign1b-EM-K4>>
<<assign1b-plot-estimatemu4>>
<<assign1b-plot-llik4>>
```

## Code for Assignment 3a
```{r, echo=TRUE, eval=FALSE, tidy=FALSE, highlight=TRUE}
<<assign3a-init>>
<<assign3a-plot>>
<<assign3a-2>>
```

## Code for Assignment 4a
```{r, echo=TRUE, eval=FALSE, tidy=FALSE, highlight=TRUE}
<<assign4a-init>>
<<assign4a-tree>>
<<assign4a-tree-plot>>
<<assign4a-forest>>
<<assign4a-forest-plot>>
```
